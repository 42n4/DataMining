---
title: "Homework 10"
author: "Neven Piculjan"
date: "2015-12-22"
output: 
  html_document:
  toc: TRUE
---
# The Homework
With the use of `all_votes` data:

* for both PAM and k-means find clustering for different number of clusters (from 2 to 20). * for each observation calculate the `silhouette` and then calculate the average silhouette score. 
* plot the average silhouette as a function of number of clusters.

#Solution
```{r, warning=FALSE, message=FALSE}
setwd("C:/Users/Neven/Desktop")
load("all_votes.rda")
head(all_votes[,1:7])
library(dplyr)
library(tidyr)
library(cluster)
new_column <- all_votes[,c(1, 3, 4)]
new_column[,2] <- ifelse(new_column[,2] == "For", 1, ifelse(new_column[,2] == "Against", -1, 0))
data <- spread(new_column, key=id_voting, vote, fill = 0)
dim(data)
row_names <- data[,1]
data <- data[,-1]
set.seed(4)
n_max = 20
silhouettes_ <- numeric(length = n_max)
for (i in 2:n_max){
  model <- kmeans(data, i, nstart = 3)
  nd <- data.frame(model$centers)
  dissE <- daisy(as.matrix(data)) 
  si <- silhouette(model$cl, dissE)
  silhouettes_[i] = mean(si[,3])
}
plot(2:n_max, silhouettes_[-1], main = "kmeans", xlab = "n of clusters", ylab = "mean silhouette", type = "o", xaxt="n", las = 1)
axis(1, 2:n_max)
silhouettes_ <- numeric(length = n_max)
for (i in 2:n_max){
  model <- pam(data, i)
  nd <- data.frame(model$centers)
  si <- silhouette(model)
  
  silhouettes_[i] = mean(si[,3])
}
plot(2:n_max, silhouettes_[-1], main = "PAM", xlab = "n of clusters", ylab = "mean silhouette", type = "o", xaxt="n", las = 1)
axis(1, 2:n_max)
```